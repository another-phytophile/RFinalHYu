---
title: "RFinalHYu"
author: "Haozhe (Jerry) Yu"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,eval=TRUE)
library(dplyr)
library(tidyr)
library(readxl)
library(here)
library(purrr)
library(ggplot2)
library(kableExtra)
```

## Data Import

### Read in Raw Data

Read in the raw data directly form the url. 

```{r rawdata}
rawhouse <- read.csv("https://www4.stat.ncsu.edu/~online/ST308/Data/hyu23_house.csv")
```

### Data Subsetting

Create a tibble from the read in data table with the following modifications: 

1. Remove any observations where
    - the `SaleType` variable takes the value "Other" or
    - the `BedroomAbvGr` variable takes on a value less than or equal to 2

2. Create a new variable with a name of your choosing that is the `SalePrice` variable divided by 100000.

3. The `GarageArea` and `MSZoning` variables are removed

```{r tibblemade}
House <- rawhouse %>%  
         filter(SaleType != "Other") %>% 
         filter(BedroomAbvGr > 2) %>% 
         mutate(SalePrice100k = SalePrice/100000) %>% 
         select(-GarageArea, -MSZoning)
```

Now print out the first 10 observations and first 6 variables of House. 

```{r kable}
House %>% 
  select(SalePrice, BsmtUnfSF, OverallQual, OpenPorchSF, BedroomAbvGr, YrSold) %>% 
  slice(1:10) %>% 
  kable()
```
## Output Creation Steps

### Contingency Tables

Create a 2 way contingency table between `BsmtFinType2` and `LotShap`.

```{r contingency}
contingency <- table(House$BsmtFinType2,
      House$LotShap)
contingency
```
The upper most value of `r contingency[1,1]` is the number of observations where `BsmtFinType2` equals "Other" and `LotShap`  euqlas "IR1". 


